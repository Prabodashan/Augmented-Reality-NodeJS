<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="data:," />
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <title>AR Site</title>
  </head>
  <body style="margin: 0px; overflow: hidden">
    <a-scene embedded arjs>
      <!-- Add the AR marker -->
      <a-marker
        preset="custom"
        type="pattern"
        url="public/patterns/pattern-heart.patt"
      >
        <!-- <a-box
          width="1"
          height="1"
          depth="1"
          color="red"
          position="0 0.5 0"
        ></a-box> -->
        <a-entity
          id="panda-entity"
          obj-model="obj: public/models/Heart.obj;"
          material="src:public/textures/hart_UV_low01_BaseColor.hart_UV_low_defaultMat.png "
          scale="0.03 0.03 0.03"
          position="0 0.5 0"
        ></a-entity>
      </a-marker>

      <a-marker
        preset="custom"
        type="pattern"
        url="public/patterns/pattern-brain.patt"
      >
        <!-- <a-obj-model
          id="my3DModel"
          src="public/models/panda.obj"
          position="0 0 0"
          rotation="-90 0 0"
          scale="1 1 1"
        ></a-obj-model> -->
        <a-entity
          id="panda-entity"
          obj-model="obj: public/models/brain.obj;"
          material="src:public/textures/COLOR.png "
          scale="0.003 0.003 0.003"
          position="0 0.5 0"
        ></a-entity>
        <!-- <a-entity
          id="text-entity"
          position="1 0.5 0"
          text="value: Hello, I'm on the right!; align: left; color: white; width: 6;"
        ></a-entity> -->
      </a-marker>
      <a-entity camera></a-entity>
    </a-scene>

    <!-- <script>
      let isMouseDown = false;
      let lastMouseX = 0;
      let lastMouseY = 0;

      // Wait for the scene to load
      document.querySelector("a-scene").addEventListener("loaded", function () {
        // Get a reference to the <a-entity> element
        const pandaEntity = document.getElementById("panda-entity");

        // Listen for mousedown event on the scene
        document
          .querySelector("a-scene")
          .addEventListener("mousedown", function (e) {
            isMouseDown = true;
            lastMouseX = e.clientX;
            lastMouseY = e.clientY;
          });

        // Listen for mousemove event on the scene
        document
          .querySelector("a-scene")
          .addEventListener("mousemove", function (e) {
            if (isMouseDown) {
              const rotationSpeed = 0.2; // Adjust the rotation speed as needed
              const rotationX = (e.clientY - lastMouseY) * rotationSpeed;
              const rotationY = (e.clientX - lastMouseX) * rotationSpeed;

              // Update the rotation of the entity
              pandaEntity.object3D.rotation.x += THREE.Math.degToRad(rotationX);
              pandaEntity.object3D.rotation.y += THREE.Math.degToRad(rotationY);

              lastMouseX = e.clientX;
              lastMouseY = e.clientY;
            }
          });

        // Listen for mouseup event on the scene
        document
          .querySelector("a-scene")
          .addEventListener("mouseup", function () {
            isMouseDown = false;
          });
      });
    </script> -->

    <script>
      let isInputActive = false;
      let lastInputX = 0;
      let lastInputY = 0;

      function startInput(x, y) {
        isInputActive = true;
        lastInputX = x;
        lastInputY = y;
      }

      function moveInput(x, y) {
        if (isInputActive) {
          const rotationSpeed = 0.2; // Adjust the rotation speed as needed
          const rotationX = (y - lastInputY) * rotationSpeed;
          const rotationY = (x - lastInputX) * rotationSpeed;

          const pandaEntity = document.getElementById("panda-entity");
          pandaEntity.object3D.rotation.x += THREE.Math.degToRad(rotationX);
          pandaEntity.object3D.rotation.y += THREE.Math.degToRad(rotationY);

          lastInputX = x;
          lastInputY = y;
        }
      }

      function endInput() {
        isInputActive = false;
      }

      // Wait for the scene to load
      document.querySelector("a-scene").addEventListener("loaded", function () {
        const scene = document.querySelector("a-scene");

        // Mouse events
        scene.addEventListener("mousedown", (e) => {
          startInput(e.clientX, e.clientY);
        });
        scene.addEventListener("mousemove", (e) => {
          moveInput(e.clientX, e.clientY);
        });
        scene.addEventListener("mouseup", endInput);

        // Touch events
        scene.addEventListener("touchstart", (e) => {
          e.preventDefault();
          const touch = e.touches[0];
          startInput(touch.clientX, touch.clientY);
        });
        scene.addEventListener("touchmove", (e) => {
          e.preventDefault();
          const touch = e.touches[0];
          moveInput(touch.clientX, touch.clientY);
        });
        scene.addEventListener("touchend", endInput);
        scene.addEventListener("touchcancel", endInput); // Add touch cancel event listener
      });
    </script>
  </body>
</html>
